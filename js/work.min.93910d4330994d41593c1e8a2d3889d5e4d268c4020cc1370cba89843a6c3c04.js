document.addEventListener("DOMContentLoaded",function(){var i,a,c,l,u,m,h=document.getElementById("roleBtn"),s=document.getElementById("roleMenu"),t=document.getElementById("roleLabel"),n=document.getElementById("techFilters"),v=document.getElementById("clearTech"),e=document.getElementById("filtersPanel"),o=document.getElementById("filtersToggle"),f=document.getElementById("filtersChevron");if(!h||!s||!t)return;function b(){try{var e=window.matchMedia&&window.matchMedia("(prefers-reduced-motion: reduce)").matches;window.scrollTo({top:0,behavior:e?"auto":"smooth"})}catch{window.scrollTo(0,0)}}function p(){var e=new URLSearchParams(location.search);return e.get("role")||""}function d(){var e=[];return n&&n.querySelectorAll('input[type="checkbox"]:checked').forEach(function(t){e.push((t.value||"").toLowerCase())}),e}function _(e){if(!n)return;var t=new Set(e.map(e=>e.toLowerCase()));n.querySelectorAll('input[type="checkbox"]').forEach(function(e){e.checked=t.has((e.value||"").toLowerCase())})}function r(e,t){var n,s=(e||"").toLowerCase(),o=new Set((t||[]).map(e=>e.toLowerCase()));document.querySelectorAll(".work-card-col").forEach(function(e){var t=(e.getAttribute("data-role")||"").toLowerCase(),n=(e.getAttribute("data-tech")||"").toLowerCase(),i=new Set(n.split(",").map(function(e){return e.trim()}).filter(Boolean)),a=!s||t===s,r=o.size===0||Array.from(o).some(function(e){return i.has(e)});e.style.display=a&&r?"":"none"}),n=new URLSearchParams(location.search),s?n.set("role",s):n.delete("role"),o.size>0?n.set("tech",Array.from(o).join(",")):n.delete("tech"),history.replaceState(null,"",n.toString()?"?"+n.toString():location.pathname)}function g(e){var n=e.querySelector("span:not(.role-count)"),s=t&&t.dataset&&t.dataset.default?t.dataset.default:"All roles",o=(n?n.textContent:e.textContent).trim();return o||s}h.addEventListener("click",function(e){e.preventDefault(),s.classList.toggle("is-open")}),s.querySelectorAll("[data-value]").forEach(function(e){e.addEventListener("click",function(e){e.preventDefault();var n=this.getAttribute("data-value")||"";t.textContent=g(this),s.classList.remove("is-open"),r(n,d())})}),n&&n.addEventListener("change",function(){r(p(),d())}),document.addEventListener("click",function(e){var s,i,a,c,l=e.target.closest(".tag-role"),u=e.target.closest(".tag-tech");if(l){i=l.closest(".work-card-col"),a=i?i.getAttribute("data-role")||"":"",t&&(t.textContent=a||t.dataset&&t.dataset.default||"All roles"),r(a,d()),o&&o.getAttribute("aria-expanded")!=="true"&&o.click(),b(),e.preventDefault();return}u&&(s=(u.textContent||"").trim(),n&&(n.querySelectorAll('input[type="checkbox"]').forEach(function(e){e.checked=!1}),c=Array.from(n.querySelectorAll('input[type="checkbox"]')).find(function(e){return(e.value||"").toLowerCase()===s.toLowerCase()}),c&&(c.checked=!0)),r(p(),s?[s]:[]),o&&o.getAttribute("aria-expanded")!=="true"&&o.click(),b(),e.preventDefault())}),v&&v.addEventListener("click",function(){n&&n.querySelectorAll('input[type="checkbox"]').forEach(function(e){e.checked=!1}),t&&(t.textContent=t.dataset&&t.dataset.default||"All roles"),r("",[])}),document.addEventListener("click",function(e){!s.contains(e.target)&&!h.contains(e.target)&&s.classList.remove("is-open")}),i="",a=[];try{l=new URLSearchParams(location.search),i=l.get("role")||"",m=l.get("tech")||"",m&&(a=m.split(",").map(function(e){return e.trim()}).filter(Boolean))}catch{}if(i&&(u=Array.from(s.querySelectorAll("[data-value]")).find(e=>(e.getAttribute("data-value")||"")===i),u&&(t.textContent=g(u))),a.length&&_(a),r(i,a),o&&e&&f){c=!1;function j(e){o.setAttribute("aria-expanded",e?"true":"false")}function w(){e.classList.add("is-open"),e.classList.remove("is-closing"),e.style.height=e.scrollHeight+"px",f.textContent="▴",j(!0);var t=function(){e.style.height="auto",e.removeEventListener("transitionend",t)};e.addEventListener("transitionend",t)}function O(){var t,n=e.scrollHeight;e.style.height=n+"px",void e.offsetHeight,s&&s.classList.remove("is-open"),e.classList.add("is-closing"),e.classList.remove("is-open"),e.style.height="0px",f.textContent="▾",j(!1),t=function(){e.classList.remove("is-closing"),e.removeEventListener("transitionend",t)},e.addEventListener("transitionend",t)}function y(e){var t=!!e;if(t===c)return;c=t,c?w():O()}o.addEventListener("click",function(e){e.preventDefault(),y(!c)}),(i&&i.length||a&&a.length)&&y(!0)}})