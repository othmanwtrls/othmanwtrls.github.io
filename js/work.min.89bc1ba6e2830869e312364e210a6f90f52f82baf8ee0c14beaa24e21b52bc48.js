document.addEventListener("DOMContentLoaded",function(){var s,o,a,c,d,u,h=document.getElementById("roleBtn"),t=document.getElementById("roleMenu"),i=document.getElementById("roleLabel"),n=document.getElementById("techFilters"),g=document.getElementById("clearTech"),e=document.getElementById("filtersPanel"),l=document.getElementById("filtersToggle"),m=document.getElementById("filtersChevron");if(!h||!t||!i)return;function j(){var e=new URLSearchParams(location.search);return e.get("role")||""}function p(){var e=[];return n&&n.querySelectorAll('input[type="checkbox"]:checked').forEach(function(t){e.push((t.value||"").toLowerCase())}),e}function y(e){if(!n)return;var t=new Set(e.map(e=>e.toLowerCase()));n.querySelectorAll('input[type="checkbox"]').forEach(function(e){e.checked=t.has((e.value||"").toLowerCase())})}function r(e,t){var n,s=(e||"").toLowerCase(),o=new Set((t||[]).map(e=>e.toLowerCase()));document.querySelectorAll(".work-card-col").forEach(function(e){var t=(e.getAttribute("data-role")||"").toLowerCase(),n=(e.getAttribute("data-tech")||"").toLowerCase(),i=new Set(n.split(",").map(function(e){return e.trim()}).filter(Boolean)),a=!s||t===s,r=o.size===0||Array.from(o).some(function(e){return i.has(e)});e.style.display=a&&r?"":"none"}),n=new URLSearchParams(location.search),s?n.set("role",s):n.delete("role"),o.size>0?n.set("tech",Array.from(o).join(",")):n.delete("tech"),history.replaceState(null,"",n.toString()?"?"+n.toString():location.pathname)}function f(e){var t=e.querySelector("span:not(.role-count)");return(t?t.textContent:e.textContent).trim()||"All roles"}h.addEventListener("click",function(e){e.preventDefault(),t.classList.toggle("is-open")}),t.querySelectorAll("[data-value]").forEach(function(e){e.addEventListener("click",function(e){e.preventDefault();var n=this.getAttribute("data-value")||"";i.textContent=f(this),t.classList.remove("is-open"),r(n,p())})}),n&&n.addEventListener("change",function(){r(j(),p())}),g&&g.addEventListener("click",function(){n&&n.querySelectorAll('input[type="checkbox"]').forEach(function(e){e.checked=!1}),i&&(i.textContent="All roles"),r("",[])}),document.addEventListener("click",function(e){!t.contains(e.target)&&!h.contains(e.target)&&t.classList.remove("is-open")}),o="",s=[];try{c=new URLSearchParams(location.search),o=c.get("role")||"",u=c.get("tech")||"",u&&(s=u.split(",").map(function(e){return e.trim()}).filter(Boolean))}catch{}if(o&&(d=Array.from(t.querySelectorAll("[data-value]")).find(e=>(e.getAttribute("data-value")||"")===o),d&&(i.textContent=f(d))),s.length&&y(s),r(o,s),l&&e&&m){a=!1;function v(e){l.setAttribute("aria-expanded",e?"true":"false")}function _(){e.classList.add("is-open"),e.classList.remove("is-closing"),e.style.height=e.scrollHeight+"px",m.textContent="▴",v(!0);var t=function(){e.style.height="auto",e.removeEventListener("transitionend",t)};e.addEventListener("transitionend",t)}function w(){var n,s=e.scrollHeight;e.style.height=s+"px",void e.offsetHeight,t&&t.classList.remove("is-open"),e.classList.add("is-closing"),e.classList.remove("is-open"),e.style.height="0px",m.textContent="▾",v(!1),n=function(){e.classList.remove("is-closing"),e.removeEventListener("transitionend",n)},e.addEventListener("transitionend",n)}function b(e){var t=!!e;if(t===a)return;a=t,a?_():w()}l.addEventListener("click",function(e){e.preventDefault(),b(!a)}),(o&&o.length||s&&s.length)&&b(!0)}})