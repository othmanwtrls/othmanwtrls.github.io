document.addEventListener("DOMContentLoaded",function(){var s,o,i,r,u,h,c=document.getElementById("roleBtn"),n=document.getElementById("roleMenu"),d=document.getElementById("roleLabel"),t=document.getElementById("techFilters"),p=document.getElementById("clearTech"),e=document.getElementById("filtersPanel"),m=document.getElementById("filtersToggle"),f=document.getElementById("filtersChevron");if(!c||!n||!d)return;function v(){var e=new URLSearchParams(location.search);return e.get("role")||""}function b(){var e=[];return t&&t.querySelectorAll('input[type="checkbox"]:checked').forEach(function(t){e.push((t.value||"").toLowerCase())}),e}function j(e){if(!t)return;var n=new Set(e.map(e=>e.toLowerCase()));t.querySelectorAll('input[type="checkbox"]').forEach(function(e){e.checked=n.has((e.value||"").toLowerCase())})}function a(e,t){var n,s=(e||"").toLowerCase(),o=new Set((t||[]).map(e=>e.toLowerCase()));document.querySelectorAll(".work-card-col").forEach(function(e){var t=(e.getAttribute("data-role")||"").toLowerCase(),n=(e.getAttribute("data-tech")||"").toLowerCase(),i=new Set(n.split(",").map(function(e){return e.trim()}).filter(Boolean)),a=!s||t===s,r=o.size===0||Array.from(o).some(function(e){return i.has(e)});e.style.display=a&&r?"":"none"}),n=new URLSearchParams(location.search),s?n.set("role",s):n.delete("role"),o.size>0?n.set("tech",Array.from(o).join(",")):n.delete("tech"),history.replaceState(null,"",n.toString()?"?"+n.toString():location.pathname)}function g(e){var t=e.querySelector("span:not(.role-count)");return(t?t.textContent:e.textContent).trim()||"Tous les rôles"}c.addEventListener("click",function(e){e.preventDefault(),n.classList.toggle("w3-show")}),n.querySelectorAll("[data-value]").forEach(function(e){e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("data-value")||"";d.textContent=g(this),n.classList.remove("w3-show"),a(t,b())})}),t&&t.addEventListener("change",function(){a(v(),b())}),p&&p.addEventListener("click",function(){if(!t)return;t.querySelectorAll('input[type="checkbox"]').forEach(function(e){e.checked=!1}),a(v(),[])}),document.addEventListener("click",function(e){!n.contains(e.target)&&!c.contains(e.target)&&n.classList.remove("w3-show")}),o="",s=[];try{r=new URLSearchParams(location.search),o=r.get("role")||"",h=r.get("tech")||"",h&&(s=h.split(",").map(function(e){return e.trim()}).filter(Boolean))}catch{}if(o&&(u=Array.from(n.querySelectorAll("[data-value]")).find(e=>(e.getAttribute("data-value")||"")===o),u&&(d.textContent=g(u))),s.length&&j(s),a(o,s),m&&e&&f){i=!e.classList.contains("w3-hide");function y(e){m.setAttribute("aria-expanded",e?"true":"false")}function _(){e.classList.remove("w3-hide"),void e.offsetWidth,e.classList.add("w3-animate-top","w3-animate-opacity"),setTimeout(function(){e.classList.remove("w3-animate-top","w3-animate-opacity")},400)}function w(){e.classList.add("w3-animate-opacity"),setTimeout(function(){e.classList.remove("w3-animate-opacity"),e.classList.add("w3-hide")},180)}function l(e){i=!!e,y(i),f.textContent=i?"▴":"▾",i?_():w()}m.addEventListener("click",function(e){e.preventDefault(),l(!i)}),l(!!(o&&o.length||s&&s.length))}})