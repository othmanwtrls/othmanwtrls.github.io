document.addEventListener("DOMContentLoaded",function(){var n,s,i,a,r,l,u=document.getElementById("roleBtn"),t=document.getElementById("roleMenu"),c=document.getElementById("roleLabel"),e=document.getElementById("techFilters"),f=document.getElementById("clearTech"),h=document.getElementById("filtersPanel"),p=document.getElementById("filtersToggle"),d=document.getElementById("filtersChevron");if(!u||!t||!c)return;function v(){var e=new URLSearchParams(location.search);return e.get("role")||""}function g(){var t=[];return e&&e.querySelectorAll('input[type="checkbox"]:checked').forEach(function(e){t.push((e.value||"").toLowerCase())}),t}function j(t){if(!e)return;var n=new Set(t.map(e=>e.toLowerCase()));e.querySelectorAll('input[type="checkbox"]').forEach(function(e){e.checked=n.has((e.value||"").toLowerCase())})}function o(e,t){var n,s=(e||"").toLowerCase(),o=new Set((t||[]).map(e=>e.toLowerCase()));document.querySelectorAll(".work-card-col").forEach(function(e){var t=(e.getAttribute("data-role")||"").toLowerCase(),n=(e.getAttribute("data-tech")||"").toLowerCase(),i=new Set(n.split(",").map(function(e){return e.trim()}).filter(Boolean)),a=!s||t===s,r=o.size===0||Array.from(o).some(function(e){return i.has(e)});e.style.display=a&&r?"":"none"}),n=new URLSearchParams(location.search),s?n.set("role",s):n.delete("role"),o.size>0?n.set("tech",Array.from(o).join(",")):n.delete("tech"),history.replaceState(null,"",n.toString()?"?"+n.toString():location.pathname)}function m(e){var t=e.querySelector("span:not(.role-count)");return(t?t.textContent:e.textContent).trim()||"Tous les rôles"}u.addEventListener("click",function(e){e.preventDefault(),t.classList.toggle("w3-show")}),t.querySelectorAll("[data-value]").forEach(function(e){e.addEventListener("click",function(e){e.preventDefault();var n=this.getAttribute("data-value")||"";c.textContent=m(this),t.classList.remove("w3-show"),o(n,g())})}),e&&e.addEventListener("change",function(){o(v(),g())}),f&&f.addEventListener("click",function(){if(!e)return;e.querySelectorAll('input[type="checkbox"]').forEach(function(e){e.checked=!1}),o(v(),[])}),document.addEventListener("click",function(e){!t.contains(e.target)&&!u.contains(e.target)&&t.classList.remove("w3-show")}),s="",n=[];try{a=new URLSearchParams(location.search),s=a.get("role")||"",r=a.get("tech")||"",r&&(n=r.split(",").map(function(e){return e.trim()}).filter(Boolean))}catch{}if(s&&(l=Array.from(t.querySelectorAll("[data-value]")).find(e=>(e.getAttribute("data-value")||"")===s),l&&(c.textContent=m(l))),n.length&&j(n),o(s,n),p&&h&&d){i=!1;function b(e){i=!!e,i?(h.classList.add("is-open"),d.textContent="▴"):(h.classList.remove("is-open"),d.textContent="▾")}p.addEventListener("click",function(e){e.preventDefault(),b(!i)}),(s&&s.length||n&&n.length)&&b(!0)}})